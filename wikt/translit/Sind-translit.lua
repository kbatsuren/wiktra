local export = {}

local consonants = {
    ["ğ‘Šº"] = "k",
    ["ğ‘Š»"] = "kh",
    ["ğ‘Š¼"] = "g",
    ["ğ‘Š½"] = "gÌˆ",
    ["ğ‘Š¾"] = "gh",
    ["ğ‘Š¿"] = "á¹…",
    ["ğ‘‹€"] = "c",
    ["ğ‘‹"] = "ch",
    ["ğ‘‹‚"] = "j",
    ["ğ‘‹ƒ"] = "jÌˆ",
    ["ğ‘‹„"] = "jh",
    ["ğ‘‹…"] = "Ã±",
    ["ğ‘‹†"] = "á¹­",
    ["ğ‘‹‡"] = "á¹­h",
    ["ğ‘‹ˆ"] = "á¸",
    ["ğ‘‹‰"] = "dÌ¤",
    ["ğ‘‹Š"] = "á¹›",
    ["ğ‘‹‹"] = "á¸h",
    ["ğ‘‹Œ"] = "á¹‡",
    ["ğ‘‹"] = "t",
    ["ğ‘‹"] = "th",
    ["ğ‘‹"] = "d",
    ["ğ‘‹"] = "dh",
    ["ğ‘‹‘"] = "n",
    ["ğ‘‹’"] = "p",
    ["ğ‘‹“"] = "ph",
    ["ğ‘‹”"] = "b",
    ["ğ‘‹•"] = "bÌ¤",
    ["ğ‘‹–"] = "bh",
    ["ğ‘‹—"] = "m",
    ["ğ‘‹˜"] = "y",
    ["ğ‘‹™"] = "r",
    ["ğ‘‹š"] = "l",
    ["ğ‘‹›"] = "v",
    ["ğ‘‹œ"] = "Å›",
    ["ğ‘‹"] = "s",
    ["ğ‘‹"] = "h",

    -- consonants with nukta
    ["ğ‘Š»ğ‘‹©"] = "x",
    ["ğ‘Š¼ğ‘‹©"] = "Ä¡",
    ["ğ‘‹‚ğ‘‹©"] = "z",
    ["ğ‘‹“ğ‘‹©"] = "f"
}

local diacritics = {["ğ‘‹ "] = "Ä", ["ğ‘‹¡"] = "i", ["ğ‘‹¢"] = "Ä«", ["ğ‘‹£"] = "u", ["ğ‘‹¤"] = "Å«", ["ğ‘‹¥"] = "e", ["ğ‘‹¦"] = "ai", ["ğ‘‹§"] = "o", ["ğ‘‹¨"] = "au", ["ğ‘‹ª"] = ""}

local nonconsonants = {
    -- vowels
    ["ğ‘Š°"] = "a",
    ["ğ‘Š±"] = "Ä",
    ["ğ‘Š²"] = "i",
    ["ğ‘Š³"] = "Ä«",
    ["ğ‘Š´"] = "u",
    ["ğ‘Šµ"] = "Å«",
    ["ğ‘Š¶"] = "e",
    ["ğ‘Š·"] = "ai",
    ["ğ‘Š¸"] = "o",
    ["ğ‘Š¹"] = "au",
    -- other symbols
    ["ğ‘‹Ÿ"] = "á¹", -- anusvara
    ["ğ‘‹©"] = ".", -- nukta
    -- digits
    ["ğ‘‹°"] = "0",
    ["ğ‘‹±"] = "1",
    ["ğ‘‹²"] = "2",
    ["ğ‘‹³"] = "3",
    ["ğ‘‹´"] = "4",
    ["ğ‘‹µ"] = "5",
    ["ğ‘‹¶"] = "6",
    ["ğ‘‹·"] = "7",
    ["ğ‘‹¸"] = "8",
    ["ğ‘‹¹"] = "9"
}

local nasal_assim = {["[kg]h?"] = "á¹…", ["[cj]h?"] = "Ã±", ["[á¹­á¸]h?"] = "á¹‡", ["[td]h?"] = "n", ["[pb]h?"] = "m", ["n"] = "n", ["m"] = "m", ["s"] = "n"}

-- translit any words or phrases
function export.tr(text, lang, sc)
    local nukta = "([ğ‘Š»ğ‘Š¼ğ‘‹‚ğ‘‹“]ğ‘‹©)"
    text = mw.ustring.gsub(text, "([ğ‘Šºğ‘Š»ğ‘Š¼ğ‘Š½ğ‘Š¾ğ‘Š¿ğ‘‹€ğ‘‹ğ‘‹‚ğ‘‹ƒğ‘‹„ğ‘‹…ğ‘‹†ğ‘‹‡ğ‘‹ˆğ‘‹‰ğ‘‹Šğ‘‹‹ğ‘‹Œğ‘‹ğ‘‹ğ‘‹ğ‘‹ğ‘‹‘ğ‘‹’ğ‘‹“ğ‘‹”ğ‘‹•ğ‘‹–ğ‘‹—ğ‘‹˜ğ‘‹™ğ‘‹šğ‘‹›ğ‘‹œğ‘‹ğ‘‹][ğ‘‹©]?)" .. "([ğ‘‹ ğ‘‹¡ğ‘‹¢ğ‘‹£ğ‘‹¤ğ‘‹¥ğ‘‹¦ğ‘‹§ğ‘‹¨]?)", function(c, d)
        -- mw.log('match', c, d)
        c = consonants[c] or c
        if d == "" then
            return c .. "a"
        else
            return c .. (diacritics[d] or d)
        end
    end)

    text = mw.ustring.gsub(text, nukta, consonants)
    text = mw.ustring.gsub(text, ".", nonconsonants)
    for key, val in pairs(nasal_assim) do text = mw.ustring.gsub(text, "á¹(" .. key .. ")", val .. "%1") end
    text = mw.ustring.gsub(text, "([aiueÄ“oÄÄ«Å«])á¹ ", "%1Ìƒ ")
    text = mw.ustring.gsub(text, "(.?)á¹", "%1Ìƒ")
    return text
end

return export
